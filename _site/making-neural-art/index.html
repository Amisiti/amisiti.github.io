<!DOCTYPE html>
<html>
	<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Making Neural Art</title>
	<meta name="viewport" content="width=device-width">
	<meta name="description" content="Joe is a software engineer living in lower manhattan that specializes in machine learning, statistics, python, and computer vision.">
	<link rel="canonical" href="/making-neural-art">
	
	<link href='//fonts.googleapis.com/css?family=Titillium+Web:400,200|Lato:300,400,700|Pacifico' rel='stylesheet' type='text/css' />
	
	<!-- Custom CSS -->
	<link rel="stylesheet" href="/css/main.css">
	<link rel="stylesheet" href="/css/icons.css">
	<script type="text/javascript"
	    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
	</script>
        
    <!-- start Mixpanel --><script type="text/javascript">(function(e,b){if(!b.__SV){var a,f,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
    for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=e.createElement("script");a.type="text/javascript";a.async=!0;a.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";f=e.getElementsByTagName("script")[0];f.parentNode.insertBefore(a,f)}})(document,window.mixpanel||[]);
    mixpanel.init("4a9ea1c313c2d3a01e19ad4f9558dba4");</script><!-- end Mixpanel -->
</head>

	
	<body>
		<header class="site-header">
	<div class="wrap">
		<a class="site-title" href="/">
		</a>
		<nav class="site-nav">
			<div class="trigger">
			</div>
		</nav>
	</div>
</header>
		
		<div class="page-content">
			<div class="wrap">
				<div class="post" style="padding:1.85em 0.75em;">
	<a class="home-link" href="/">Back To Blog Posts</a>
    <header class="post-header">
		<p class="meta">Sep 27, 2015
            </p>
		
		<h1>Making Neural Art</h1>
	</header>
	
	<article class="post-content">
		<p>A few weeks ago the blogosphere [1] went kinda crazy when <a href="http://arxiv.org/pdf/1508.06576v1.pdf">A Neural Algorithm of Artistic Style</a> was published. I have to admit, I thought the results were pretty impressive and was looking forward to playing with the algorithm myself. All I needed was </p>

<ol>
  <li><a href="https://github.com/andersbll">Someone</a> to implement the algorithm for me (too busy and lazy to do it myself)</li>
  <li>A GPU</li>
  <li>Some free time</li>
</ol>

<p>The following are some notes I took on how to get started. I hope they help.</p>

<h4 id="the-setup">The Setup</h4>

<p>I started with launching an GPU instance, pre-installed with CUDA, etc. on Amazonâ€™s US-East data center (ami-55deaf30). I actually initially tried to install the software myself, but was unable so I moved on. I have a separate repo for my installation work <a href="https://github.com/josephmisiti/deep-learning-scripts">here</a>. </p>

<p>After your instance is running, login and you need to start installing software. First we need to install <a href="https://github.com/andersbll/cudarray">cudarray</a>.</p>

<p><code>
git clone https://github.com/andersbll/cudarray
cd cudarray
</code></p>

<p>I also followed the directions and set the following variables up before building anything (add these to your bashrc and do not forget to call <code>source</code> before building)</p>

<p><code>
export CUDNN_ENABLED=1
export INSTALL_PREFIX=/usr/local/
export CUDA_PREFIX=/usr/local/cuda-7.5/
</code></p>

<p>Now it is time to build the library:</p>

<p><code>
make; 
sudo make install; 
</code></p>

<p>Assuming you do not have any issues with building the library, you can now install the python bindings:</p>

<p><code>
sudo python setup.py install
</code></p>

<p>Next, we need to install the <a href="https://github.com/andersbll/deeppy">deeppy</a> library.</p>

<p><code>
git clone https://github.com/andersbll/deeppy
cd deeppy
sudo python setup.py install
</code></p>

<p>I had no problem at this point but when I ran the command the software could not find the CUDA libraries:</p>

<p><code>
ubuntu@ip-172-31-16-25:~/neural_artistic_style$ python neural_artistic_style.py --subject images/tuebingen.jpg --style images/starry_night.jpg
/usr/lib/python2.7/dist-packages/pkg_resources.py:1031: UserWarning: /home/ubuntu/.python-eggs is writable by group/others and vulnerable to attack when used with get_resource_filename. Consider a more secure location (set with .set_extraction_path or the PYTHON_EGG_CACHE environment variable).
  warnings.warn(msg, UserWarning)
CUDArray: CUDA back-end not available, using NumPy.
</code></p>

<p><a href="https://github.com/andersbll/neural_artistic_style/issues/20">Fixing this</a> was as simple as setting the <code>LD_LIBRARY_PATH</code> so the software could find the appropriate shared libarires:</p>

<p><code>
export LD_LIBRARY_PATH='/home/ubuntu/cudarray/build/;/usr/local/cuda-7.5/targets/x86_64-linux/lib/'
</code></p>

<p>That is it, I was able to utlize the library and make neural art:</p>

<p><img src="/images/posts/NN_input.png" alt="input" /></p>

<p><img src="/images/posts/NN_output.png" alt="output" /></p>

<p><img src="/images/posts/NN_output_1.png" alt="output" /></p>

<p><img src="/images/posts/NN_output_2.png" alt="output" /></p>

<p><img src="/images/posts/NN_output_3.png" alt="output" /></p>

<p>[1] http://www.dailymail.co.uk/sciencetech/article-3214634/The-algorithm-learn-copy-artist-Neural-network-recreate-snaps-style-Van-Gogh-Picasso.html</p>

	</article>
    
    <script>
        mixpanel.track("Making Neural Art");
    </script>
    
</div>
			</div>
		</div>
		<footer class="site-footer">
	<div class="wrap">
		<div class="footer-col-1 column">
			<ul>
				<li>Math, CS, Statsitics, and the occasional book review</li>
				<li>
					<a href="mailto:"></a>
				</li>
			</ul>
		</div>
		
		<div class="footer-col-2 column">
			<ul>
				<li>
					<a class="icons icon-signup" href="/feed.xml"></a>
				</li>
				
				<li>
					<a class="icons icon-github2" href="https://github.com/">
						<span class="username"></span>
					</a>
				</li>
				
				<li>
					<a class="icons icon-twitter" href="https://twitter.com/">
						<span class="username"></span>
					</a>
				</li>
			</ul>
		</div>
		
		<div class="footer-col-3 column">
			<p class="text">Joe is a software engineer living in lower manhattan that specializes in machine learning, statistics, python, and computer vision.</p>
		</div>
	</div>
</footer>
	</body>
</html>